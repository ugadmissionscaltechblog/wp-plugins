class authorshipByline{constructor(t,i){this.type=i,this.byline=t,this.valid=!0,this.names=[],this.links=[],this.href=this.byline.getAttribute("href"),this.url=new URL(decodeURIComponent(this.href)),this.params=new URLSearchParams(this.url.search),this.origin=this.url.origin,this.path=this.url.pathname,this.postId=0,this.params.has("mab_v3")&&(this.postId=this.params.get("mab_v3")),this.lang="",this.params.has("lang")&&(this.lang="?lang="+this.params.get("lang")),this.check()?this.parseData():this.valid=!1}check(){let t=!0;return""===this.byline.innerText&&(this.params.has("m_main_disabled")?this.byline.removeAttribute("href"):this.byline.setAttribute("href",this.origin+this.path+this.lang),t=!1),t}parseData(){switch(this.type){case"v1":case"v2":var t=[molongui_authorship_byline_params.byline_separator,molongui_authorship_byline_params.byline_last_separator];this.names=this.byline.innerText.split(new RegExp(t.join("|"),"gi")),this.params.has("m_main_disabled")?(this.links=this.params.getAll("mca"),this.links.unshift("molongui-disabled-link")):(t=this.path.replace(/^\/|\/$/g,"").split("/").pop(),this.path.replace(/\/$/g,"").replace(t,""),this.links=this.params.getAll("mca"),this.links.unshift(this.origin+this.path+this.lang));break;case"v3":var t=window["molongui_authorship_byline_data_"+this.postId];Object.values(t).forEach(function(t){this.names.push(t.name),this.links.push(t.url)},this),this.names.length!==this.links.length&&(t="Byline for post #"+this.postId+" is probably wrong, names count doesn't match links count.",console.log("%c MOLONGUI AUTHORSHIP %c\n"+t+"\n"+this.byline,"background: #fdfdc6; font-weight: bold; color: #555",""))}}replace(){let e=[molongui_authorship_byline_params.byline_separator,molongui_authorship_byline_params.byline_last_separator],s="",a=this.names.length,t=this.byline.getAttribute("class"),i=this.byline.getAttribute("target"),n=this.byline.getAttribute("rel"),r=this.byline.getAttribute("itemprop");var l='class="'+(t?t+" ":"")+molongui_authorship_byline_params.byline_link_class+'"',o=i?'target="'+i+'"':"",h=n?'rel="'+n+'"':"",u=r?'itemprop="'+r+'"':"";s=molongui_authorship_byline_params.byline_dom_prepend;for(let i=0;i<a;i++){var p=this.names[i].trim();let t="";t=""!==molongui_authorship_byline_params.byline_dom_tree?molongui_authorship_byline_params.byline_dom_tree.replace("{%ma_authorName}",p):p,"molongui-disabled-link"===this.links[i]||i>=this.links.length?s+=t:s+='<a href="'+this.links[i]+'" '+l+" "+h+" "+u+" "+o+' title="'+molongui_authorship_byline_params.byline_link_title+" "+p+'">'+t+"</a>",i<a-1-1?s+=e[0]:i<a-1&&(s+=e[1])}s+=molongui_authorship_byline_params.byline_dom_append,this.byline.insertAdjacentHTML("afterend",s),this.byline.parentNode.removeChild(this.byline)}isValid(){return this.valid}getNames(){return this.names}getLinks(){return this.links}}let getBylines=function(t){let i;return i="v3"===t?document.querySelectorAll('a[href*="mab_v3="]'):document.querySelectorAll('a[href*="molongui_byline=old"]')},addBylineCoauthors=function(){let e=molongui_authorship_byline_params.byline_decoder;var t=getBylines(e);Array.prototype.forEach.call(t,function(t,i){t=new authorshipByline(t,e);t.isValid()&&t.replace()})},addBylineModifiers=function(){const e="?m_bm=true";var t=document.querySelectorAll('a[href$="'+e+'"]');Array.prototype.forEach.call(t,function(t,i){t.setAttribute("href",decodeURIComponent(t.getAttribute("href")).replace(e,"")),t.insertAdjacentHTML("beforebegin",molongui_authorship_byline_params.byline_prefix+" "),t.insertAdjacentHTML("afterend"," "+molongui_authorship_byline_params.byline_suffix)})},removeEmptyLinks=function(){var t=document.querySelectorAll('a[href="#molongui-disabled-link"]');Array.prototype.forEach.call(t,function(t,i){t.classList.add("molongui-disabled-link"),t.removeAttribute("href")})},initBylines=function(){addBylineModifiers(),addBylineCoauthors(),removeEmptyLinks()};document.addEventListener("DOMContentLoaded",function(){initBylines();var t=document.body;new MutationObserver(function(t){Array.prototype.forEach.call(t,function(t,i){void 0!==t.target.classList&&"m-a-box-container"===t.target.classList.value||initBylines()})}).observe(t,{attributes:!0,childList:!0,subtree:!0,characterData:!0})});